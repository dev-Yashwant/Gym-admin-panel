<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Information</title>
	<link rel="stylesheet" type="text/css"  href="css/userview.css">
</head>

<body class="form-v10">

    

    <div class="page-content">
        <div class="form-v10-content">
            <form class="form-detail"  id="myform">
                <div class="form-left">
                    <h2>Personal Information</h2>
                        <div class="form-row form-row-1">
							<input type="text" name="namee" id="namee" class="input-text"
								placeholder="Name"  required>
						</div>
                        <div class="form-row form-row-2">
                            <input type="tel" name="phone" id="phone" class="input-tel"
								placeholder="Phone" maxlength="10" required>
                        </div>
                        <div class="form-row">
                            <input type="text" name="email" id="email" class="input-text" required
                                pattern="[^@]+@[^@]+.[a-zA-Z]{2,6}" placeholder="Your Email">
                        </div>
                        <div class="form-row">
                            <input type="text" name="address" class="address" id="address"
                                placeholder="Address" required>
                        </div>
                </div>
                    <div class="form-right">
                        <h2>Gym Information</h2>
                        <div class="form-group">
                            <div class="form-row form-row-1">
                                <input placeholder="Date of join &nbsp"type="text" onfocus="(this.type='date')"id="dateOfJoin" name="dateOfJoin" required >
                            </div>
                            <div class="form-row form-row-2">
                                <input placeholder="Date of Expire &nbsp" type="text" onfocus="(this.type='date')" id="dateOfExpire" name="dateOfExpire" required><br>
                            </div>
                        </div>
                        <div class="form-group">
                        <div class="form-row form-row-1">
                            <input type="number" name="height" id="height" required placeholder="Height (cm)">
                        </div>
                        <div class="form-row form-row-2">
                            <input type="number" name="weight" id="weight" required placeholder="Weight (kg)"><br>
                        </div>
                        </div>
                        <div class="form-group">
                            <div class="form-row form-row-1">
                                <input type="number" name="bicep" id="bicep" required placeholder="Upper Arm (cm)"><br>
                            </div>
                        <div class="form-row form-row-2">
                                <input type="number" name="waist" id="waist" required placeholder="Chest Normal(cm)"><br>
                        </div>
                        </div>
                        <div class="form-group">
                            <div class="form-row form-row-1">
                                <input type="number" name="shoulder" id="shoulder" required placeholder="Shoulder (cm)"><br>
                            </div>
                            <div class="form-row form-row-2">
                                <input type="number" name="chest" id="chest" required placeholder="Waist (cm)"><br>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="form-row form-row-1">
                                <input type="number" name="hips" id="hips" required placeholder="Hips (cm)">
                            </div>
                            <div class="form-row form-row-2">
                                <input type="number" name="thigh" id="thigh" required placeholder="Thighs (cm)">
                            </div>
                        </div>
                        <div class="form-row form-row-1">
                            <input type="number" name="age" id="age"required placeholder="Age"><br>
                        </div>
                        <div class="form-checkbox">
                            <label class="container">
                                <p>I do accept the <a href="#" class="text">Terms and Conditions</a> of your site.</p>
                                <input type="checkbox" name="checkbox">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="form-row-last">
                            <button class="button" onclick=updateUserData()>Update</button>
                        </div>  
                    </div>
            </form>
        </div>
    </div>

    <script>
        // Add this line at the end of your script to call viewUserData immediately on page load
         document.addEventListener('DOMContentLoaded', () => {
                    // Retrieve user details from query parameters
                    const params = new URLSearchParams(window.location.search);
                    const userId = params.get('id');
                    viewUserData(userId);            
        
         })
        
        
        
        // Function to fetch and populate user data
        function viewUserData(userId) {
            // Retrieve the user ID entered by the user
        
            // Make an AJAX request to fetch user data
            const xhr = new XMLHttpRequest();
            
            // Include the user ID as a query parameter in the URL
            xhr.open('GET', `/fetchUserData?id=${encodeURIComponent(userId)}`, true);
        
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    // Handle the response from the server
                    const userData = JSON.parse(xhr.responseText);
        
                    // Populate the form fields with the retrieved information
                    document.getElementById("namee").value = userData.namee;
                    document.getElementById("phone").value = userData.phone;
                    document.getElementById("email").value = userData.email;
                    document.getElementById("address").value = userData.address;
                    document.getElementById("dateOfJoin").value = userData.dateOfJoin;
                    document.getElementById("dateOfExpire").value = userData.dateOfExpire;
                    document.getElementById("height").value = userData.height;
                    document.getElementById("weight").value = userData.weight;
                    document.getElementById("bicep").value = userData.bicep;
                    document.getElementById("waist").value = userData.waist;
                    document.getElementById("thigh").value = userData.thigh;
                    document.getElementById("chest").value = userData.chest;
                    document.getElementById("age").value = userData.age;
                    document.getElementById("hips").value = userData.hips;
                    document.getElementById("shoulder").value = userData.shoulder;
                }
            };
            xhr.send();
        }
	
		function updateUserData() {
            event.preventDefault();
            const userId = new URLSearchParams(window.location.search).get('id');
    
    if (!userId) {
        console.error('User ID not found or invalid.');
        return;
    }

    const isConfirmed = confirm("Are you sure you want to update this user's data?");
    
    if (isConfirmed) {
        const updatedData = {
<<<<<<< HEAD
		    //namee: document.getElementById("namee").value,
=======
			 //namee: document.getElementById("namee").value,
>>>>>>> dfcbc1f0cdc79f7351f7e9fbf97d08f6caeb11cc
			phone: document.getElementById("phone").value,
			email: document.getElementById("email").value,
			address: document.getElementById("address").value,
			dateOfJoin: document.getElementById("dateOfJoin").value,
			dateOfExpire: document.getElementById("dateOfExpire").value,
			height: document.getElementById("height").value,
			weight: document.getElementById("weight").value,
			bicep: document.getElementById("bicep").value,
			waist: document.getElementById("waist").value,
			thigh: document.getElementById("thigh").value,
			chest: document.getElementById("chest").value,
			age: document.getElementById("age").value,
			hips: document.getElementById("hips").value,
			shoulder: document.getElementById("shoulder").value,
			// Get values of other input fields...
        };

        const xhr = new XMLHttpRequest();
        xhr.open('PUT', `/updateUserData?id=${encodeURIComponent(userId)}`, true);
        xhr.setRequestHeader('Content-Type', 'application/json');

     xhr.onload = function () {
    if (xhr.status === 200) {
        alert('User data updated successfully!');
        window.location.href = `/userview?id=${encodeURIComponent(userId)}`;
    } else {
        console.error('Error updating user data:', xhr.status, xhr.statusText, xhr.responseText);
    }
};

        xhr.send(JSON.stringify(updatedData));
    } else {
        console.log("Update canceled by the user.");
    }
}

</script>
</body>

</html>
